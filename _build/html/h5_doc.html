<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started: Normal Mode &mdash; MadeiraCloud Document 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/docs.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MadeiraCloud Document 1.0.0 documentation" href="index.html" />
    <link rel="prev" title="Madeira Cloud Documentation" href="default.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <!--
        <ul>
          <li class="right" style="margin-right: 10px">
            <a href="genindex.html" title="General Index"
               accesskey="I">index</a></li>
          <li class="right" >
            <a href="default.html" title="Madeira Cloud Documentation"
               accesskey="P">previous</a> |</li>
          <li><a href="default.html">MadeiraCloud Document 1.0.0 documentation</a> &raquo;</li> 
        </ul>
      -->
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body markdown-body">
            
  <div class="section" id="getting-started-normal-mode">
<h1>Getting Started: Normal Mode<a class="headerlink" href="#getting-started-normal-mode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>MadeiraCloud groups your resources and manages them as a single unit,
either an “App” or a “Stack”. The concept is similar to VMware&#8217;s vApp
and OVF:</p>
<ul class="simple">
<li>A Stack is a template of an application containing everything that&#8217;s
needed to run it, e.g., code, servers, storage, network
configuration, etc., but in a static, re-usable form.</li>
<li>An App is a live instance of a Stack. When launching a Stack, all of
its component resources will be provisioned and configured as
specified in the Stack to create a running version as an App. Apps
can be monitored and managed as one entity, making backups easy.</li>
</ul>
<p>Put simply, an App is everything to do with a running setup and a Stack
is like a snapshot or image of an entire App. Stacks are reusable so
they can be launched into multiple apps which will then each have their
own unique component resources with no conflicts.</p>
</div>
<div class="section" id="connecting-madeiracloud-and-aws">
<h2>2. Connecting MadeiraCloud and AWS<a class="headerlink" href="#connecting-madeiracloud-and-aws" title="Permalink to this headline">¶</a></h2>
<p>An Amazon Web Services account is required in order to get full
functionality from MadeiraCloud.</p>
<div class="section" id="prerequisites">
<h3>2.1 Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>If you haven&#8217;t already, please sign up for an AWS account (EC2 is
mandatory).</li>
<li>And obviously, a Madeira account is also required. You can sign up
for a free account here.</li>
</ul>
</div>
<div class="section" id="entering-your-credentials">
<h3>2.2 Entering your Credentials<a class="headerlink" href="#entering-your-credentials" title="Permalink to this headline">¶</a></h3>
<p>The next step is to let us know your AWS account credentials in order
for MadeiraCloud to connect with AWS on your behalf.</p>
<p>You should be promped at your first connection to MadeiraCloud IDE. If
not, or if you want to update your credentials, login to MadeiraCloud
IDE, then click on your username on the top-right corner and &#8220;AWS
Credential&#8221;.</p>
<div class="figure">
<img alt="" src="aws_cred.png" />
</div>
<p>You can find your AWS credentials by clicking here or selecting
&#8216;Security Credentials&#8217; from the &#8216;My Account/Console&#8217; menu:</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-connect-sec.png" />
</div>
<p>After logging in, you can find your Account Number in the top right of
the page, just under your username:</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-connect-acc.png" />
</div>
<p>This is optional, but is needed for some advanced features such as
sharing an EC2 AMI or EBS snapshot with other users.</p>
<p>Your Access Key and Secret Access Key can be found on the same page,
under access credentials:</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-connect-keys.png" />
</div>
<p>This is required in order for us to use AWS&#8217; Rest APIs to let you manage
your AWS account through our application.</p>
<p>Just copy and paste these three pieces of information in to your Madeira
AWS page, hit save and you are done.</p>
</div>
</div>
<div class="section" id="b-connecting-madeiracloud-and-aws-using-iam">
<h2>2b. Connecting MadeiraCloud and AWS using IAM<a class="headerlink" href="#b-connecting-madeiracloud-and-aws-using-iam" title="Permalink to this headline">¶</a></h2>
<div class="section" id="make-sure-iam-access-is-enabled">
<h3>Make sure IAM access is enabled.<a class="headerlink" href="#make-sure-iam-access-is-enabled" title="Permalink to this headline">¶</a></h3>
<p>Log in to your AWS account and then go here.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-active.png" />
</div>
<p>Scroll down to the IAM user access section and make sure both the
&#8216;Account Activity Page&#8217; and &#8216;Usage Reports Page&#8217; checkboxes are ticked
and then click Activate Now.</p>
</div>
<div class="section" id="create-a-user-for-use-with-madeiracloud">
<h3>Create a user for use with MadeiraCloud.<a class="headerlink" href="#create-a-user-for-use-with-madeiracloud" title="Permalink to this headline">¶</a></h3>
<p>Go to the AWS Console and click the IAM tab, then create a group for
your user. You can call it anything you like, but something Madeira
related probably makes sense!</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-create-group.png" />
</div>
<p>Click &#8216;Select&#8217; after &#8216;Amazon EC2 Full Access&#8217;.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-ec2-full.png" />
</div>
<p>Here you can review the permissions. If you are happy, click &#8216;Continue&#8217;.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-policy.png" />
</div>
<p>Then click the &#8216;Create New Users&#8217; tab and enter a name for the new user.
Leave &#8216;Generate an access key for each User&#8217; ticked and then click
&#8216;Continue&#8217;.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-new.png" />
</div>
<p>Review your settings and click &#8216;Finish&#8217;.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-review.png" />
</div>
<p>The IAM account has now been created. Click &#8216;Show User Security
Credentials&#8217;.</p>
<div class="figure">
<img alt="" src="https://s3-ap-northeast-1.amazonaws.com/madeiraassets/kb/kb-iam-cred.png" />
</div>
<p>You can now see the Access Key ID and Secret Access Key for this user.</p>
<p>Copy and paste these into your Madeira AWS Credentials page and click
&#8216;Save&#8217; and you&#8217;re done!</p>
</div>
</div>
<div class="section" id="designing-a-simple-stack-drupal-mysql-ha-example">
<h2>3. Designing a simple Stack (Drupal MySQL HA example)<a class="headerlink" href="#designing-a-simple-stack-drupal-mysql-ha-example" title="Permalink to this headline">¶</a></h2>
<p>For this example, we&#8217;re going to create a simple Stack for quickly
deploying a Drupal CMS site with MySQL master and slave databases.</p>
<ol class="arabic simple">
<li>Log in to the IDE</li>
<li>Create a new Stack by clicking &#8220;Create new Stack&#8221; on the top left of
the IDE dashboard</li>
<li>Choose the AWS region where you want to create your Stack <img alt="image0" src="create_stack.png" /></li>
<li>Select &#8220;Classic&#8221; in the following menu (see VPC mode - Part xxx for
VPC) <img alt="image1" src="create_stack_menu.png" /></li>
<li>From the resource panel on the left, select the Availability Zone of
your choice and drag&#8217;n&#8217;drop it to the canvas (Note: Availability
Zones depend on regions) <img alt="image2" src="availability_zones.png" /></li>
<li>Following the same principle, drag&#8217;n&#8217;drop 3 instances (&#8216;Images&#8217;
menu) inside the previously created Availability Zone (Note: We will
use 64bits Amazon Linux AMIs in this example) <img alt="image3" src="create_instances.png" /></li>
<li>Click on each AMI icon and set the hostnames to the following in the
right pannel <img alt="image4" src="name_instances.png" /></li>
<li>Associate an EIP to every instance. Pay attention to keep them
associated until the execution of the Stack (the icon should be
colored) <img alt="image5" src="add_eip.png" /></li>
<li>Define two Security Groups, one for the front-end web server and one
for the two back-end database servers Click on the web instance and
then &#8220;Create new Security Group&#8221; in the &#8220;Security Groups&#8221; menu in
the right pannel: <img alt="image6" src="add_sg.png" /> Name this Security Group &#8220;front&#8221;:
<img alt="image7" src="add_sg_front.png" /> Go back and assign the web instance to &#8220;front&#8221;, then
remove it from the default Security Group: <img alt="image8" src="add_web_front.png" /> Repeat the
same operation to create a new &#8220;back&#8221; Security Group: <img alt="image9" src="add_sg_back.png" />Then add the two &#8220;primarydb&#8221; and &#8220;slavedb&#8221; instances to the &#8220;back&#8221;
Security Group, removing them from the default SG. <img alt="image10" src="add_db_back.png" /></li>
<li>Create the Security Rules to link the instances together Click on
one of the &#8220;back&#8221; instances, then in the &#8220;Security Groups&#8221; menu in
the right pannel, click on the right arrow on the right of the
&#8220;back&#8221; SG to access its properties. In this menu, click on the &#8220;+&#8221;
button to add a new rule. <img alt="image11" src="add_rule.png" /> Start by adding a first rule
allowing the SSH connection to your instances (allow all connections
from port 22, following TCP protocol, inbound) for remote management
(note: the source(s) IP(s)/range must follow the CIDR notation).
<img alt="image12" src="add_ssh_rule.png" /> Add a new rule to allow SQL connections from the &#8220;front&#8221;
Security Group (port 3306, TCP). <img alt="image13" src="add_front_rule.png" /> Following the same
method, add a new rule to allow all TCP traffic between all the
instances of this Security Group (ports 1-65535). You may as well
want to allow all UDP and ICMP traffic. You should at least have the
following rules: <img alt="image14" src="back_rules.png" /> Repeat the same operation for the
&#8220;front&#8221; Security Group, in order to get the following rules.
<img alt="image15" src="front_rules.png" /> Congratulations! Your Stack is now set and ready to be
launched!</li>
<li>Click on the blank area of the canvas to put the focus on the Stack
properties. Name the Stack as &#8220;drupal-mysql-ha&#8221; in the right pannel,
then click on the same icon on the left side of the top bar.
<img alt="image16" src="save_stack.png" /></li>
<li>Launch the Stack by clicking on the &#8220;Run Stack&#8221; button. <img alt="image17" src="run_stack.png" /></li>
<li>Name the App in the pop-up window, then click on &#8220;Run Stack&#8221;.
<img alt="image18" src="name_app.png" /></li>
<li>Wait until the App to be launched. <img alt="image19" src="start_app.png" /></li>
<li>Once started, your App should looks like the following: <img alt="image20" src="app_started.png" /></li>
<li>Click on the web instance to get the instance properties. You can
see here all details concerning the running instance on the right
pannel. We will pay attention here to the &#8220;Primary Public IP&#8221; and
the &#8220;Key Pair&#8221;. <img alt="image21" src="app_details.png" /></li>
<li>You can now click on the link under &#8220;Key Pair&#8221;
(&#8220;DefaultKP&#8212;app-f364db3b&#8221; here) to download the key file and get
the standard SSH connection command. <img alt="image22" src="dl_key.png" /></li>
</ol>
</div>
<div class="section" id="setting-up-your-application-drupal-mysql-ha-example">
<h2>4. Setting up your application (Drupal MySQL HA example)<a class="headerlink" href="#setting-up-your-application-drupal-mysql-ha-example" title="Permalink to this headline">¶</a></h2>
<p>After following the steps in Part 3 - Designing a simple Stack, your
application is now running, and you have downloaded the KeyPair for the
application.</p>
<p>You will now need to SSH into the web instance. You can use any terminal
client to do so. If you are running under Windows, which doesn&#8217;t have
any SSH compatible terminal embedded, we recomment PuTTY. In this case,
you will also need to know how to connect to Linux/UNIX Instances from
PuTTY.</p>
<div class="section" id="disclamer">
<h3>Disclamer<a class="headerlink" href="#disclamer" title="Permalink to this headline">¶</a></h3>
<p>Please, be aware that these steps are informative, given as an example,
and may differ (more, or less) from the reality, due to anyone&#8217;s
configuration.</p>
<p>We can&#8217;t provide any warranty or support if you face issues during this
phase, then be sure of what you are doing while setting up your
applications.</p>
</div>
<div class="section" id="setting-up-the-instances">
<h3>Setting up the instances<a class="headerlink" href="#setting-up-the-instances" title="Permalink to this headline">¶</a></h3>
<p>In this example, all the instances are running Amazon Linux, so write:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">curl</span> <span class="pre">-s</span> <span class="pre">http://download.madeiracloud.com/setup/amazon.sh</span> <span class="pre">|</span> <span class="pre">sh&quot;</span></tt></li>
</ul>
<p>to the terminal for each instance as the root user.</p>
</div>
<div class="section" id="deploying-drupal">
<h3>Deploying Drupal<a class="headerlink" href="#deploying-drupal" title="Permalink to this headline">¶</a></h3>
<p>SSH into the &#8216;web&#8217; instance and write the following commands in order to
install Drupal:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">su</span> <span class="pre">-</span></tt></li>
<li><tt class="docutils literal"><span class="pre">yum</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">httpd</span> <span class="pre">php</span> <span class="pre">php-gd</span> <span class="pre">php-mysql</span> <span class="pre">php-xml</span> <span class="pre">php-mbstring</span> <span class="pre">mysql</span></tt></li>
<li><tt class="docutils literal"><span class="pre">chkconfig</span> <span class="pre">httpd</span> <span class="pre">on</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cd</span> <span class="pre">/var/www/html/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">wget</span> <span class="pre">http://ftp.drupal.org/files/projects/drupal-x.xx.tar.gz</span></tt>
(replace <tt class="docutils literal"><span class="pre">x.xx</span></tt> with the latest version number from the Drupal
site.)</li>
<li><tt class="docutils literal"><span class="pre">tar</span> <span class="pre">xzf</span> <span class="pre">drupal-x.xx.tar.gz</span></tt> (replace <tt class="docutils literal"><span class="pre">x.xx</span></tt> by your version
number)</li>
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">drupal-x.xx.tar.gz</span></tt> (then type <tt class="docutils literal"><span class="pre">y</span></tt> to confirm)</li>
<li><tt class="docutils literal"><span class="pre">mv</span> <span class="pre">drupal-x.xx/*</span> <span class="pre">.</span></tt></li>
<li><tt class="docutils literal"><span class="pre">rm</span> <span class="pre">-rf</span> <span class="pre">drupal-x.xx/</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mkdir</span> <span class="pre">-p</span> <span class="pre">/var/www/html/sites/default/files</span></tt></li>
<li><tt class="docutils literal"><span class="pre">cp</span> <span class="pre">sites/default/default.settings.php</span> <span class="pre">sites/default/settings.php</span></tt></li>
<li><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">757</span> <span class="pre">-R</span> <span class="pre">/var/www/html/sites/default/files</span></tt></li>
<li><tt class="docutils literal"><span class="pre">chmod</span> <span class="pre">646</span> <span class="pre">/var/www/html/sites/default/settings.php</span></tt></li>
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">httpd</span> <span class="pre">start</span></tt></li>
</ol>
</div>
<div class="section" id="configure-the-primarydb">
<h3>Configure the primarydb<a class="headerlink" href="#configure-the-primarydb" title="Permalink to this headline">¶</a></h3>
<p>SSH into the &#8216;primarydb&#8217; instance and write the following commands in
order to configure the databases:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">su</span> <span class="pre">-</span></tt></li>
<li><tt class="docutils literal"><span class="pre">chkconfig</span> <span class="pre">mysqld</span> <span class="pre">on</span></tt></li>
<li><tt class="docutils literal"><span class="pre">service</span> <span class="pre">mysqld</span> <span class="pre">start</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/usr/bin/mysqladmin</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">password</span> <span class="pre">xxx</span></tt> (replace <tt class="docutils literal"><span class="pre">xxx</span></tt> with a
secure password of your choice)</li>
<li><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span></tt> (then enter your password and press enter)</li>
<li><tt class="docutils literal"><span class="pre">GRANT</span> <span class="pre">ALL</span> <span class="pre">ON</span> <span class="pre">*.*</span> <span class="pre">TO</span> <span class="pre">root&#64;'%'</span> <span class="pre">IDENTIFIED</span> <span class="pre">BY</span> <span class="pre">'letmein'</span> <span class="pre">WITH</span> <span class="pre">GRANT</span> <span class="pre">OPTION;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">FLUSH</span> <span class="pre">PRIVILEGES;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATABASE</span> <span class="pre">drupal;</span></tt> (or replace <tt class="docutils literal"><span class="pre">drupal</span></tt> with a database
name of your choice)</li>
</ol>
</div>
<div class="section" id="setting-up-drupal">
<h3>Setting up Drupal<a class="headerlink" href="#setting-up-drupal" title="Permalink to this headline">¶</a></h3>
<p>Open your browser and access: <a class="reference external" href="http:/">http:/</a>/{web-public-hostname}:</p>
<ol class="arabic simple">
<li>Select the type of installation you would like and click
<tt class="docutils literal"><span class="pre">Save</span> <span class="pre">and</span> <span class="pre">Continue</span></tt></li>
<li>Select a language and click <tt class="docutils literal"><span class="pre">Save</span> <span class="pre">and</span> <span class="pre">Continue</span></tt></li>
<li>Leave <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">type</span></tt> as <tt class="docutils literal"><span class="pre">MySQL,</span> <span class="pre">MariaDB,</span> <span class="pre">or</span> <span class="pre">equivalent</span></tt></li>
<li>Enter the name you entered earlier for <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">name</span></tt>, e.g.,
<tt class="docutils literal"><span class="pre">drupal</span></tt></li>
<li>For <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">username</span></tt> enter <tt class="docutils literal"><span class="pre">root</span></tt></li>
<li>For <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">password</span></tt> enter the password you entered earlier,
e.g., <tt class="docutils literal"><span class="pre">xxx</span></tt></li>
<li>Click to expand <tt class="docutils literal"><span class="pre">ADVANCED</span> <span class="pre">OPTIONS</span></tt></li>
<li>For <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">host</span></tt> enter <tt class="docutils literal"><span class="pre">primarydb</span></tt></li>
<li>For <tt class="docutils literal"><span class="pre">Database</span> <span class="pre">port</span></tt> enter <tt class="docutils literal"><span class="pre">3306</span></tt> and click <tt class="docutils literal"><span class="pre">Save</span> <span class="pre">and</span> <span class="pre">Continue</span></tt></li>
<li>Complete the remainder of the Drupal wizard</li>
</ol>
</div>
<div class="section" id="setting-up-mysql-ha">
<h3>Setting up MySQL HA<a class="headerlink" href="#setting-up-mysql-ha" title="Permalink to this headline">¶</a></h3>
<p>SSH into primarydb and write the following commands:</p>
<ol class="arabic">
<li><p class="first"><tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">su</span> <span class="pre">-</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span></tt> (then enter password and hit enter)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">GRANT</span> <span class="pre">REPLICATION</span> <span class="pre">SLAVE,</span> <span class="pre">REPLICATION</span> <span class="pre">CLIENT</span> <span class="pre">ON</span> <span class="pre">*.*</span> <span class="pre">TO</span> <span class="pre">root&#64;'slave_db'</span> <span class="pre">IDENTIFIED</span> <span class="pre">BY</span> <span class="pre">'xxx';</span></tt>
(replace <tt class="docutils literal"><span class="pre">xxx</span></tt> by your mysql password)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">FLUSH</span> <span class="pre">PRIVILEGES;</span></tt> (Then press Ctrl-C to quit MySQL)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">nano</span> <span class="pre">/etc/my.cnf</span></tt> (or use the editor of your choice, as <tt class="docutils literal"><span class="pre">vi</span></tt> or
<tt class="docutils literal"><span class="pre">emacs</span></tt>)</p>
</li>
<li><p class="first">at the end of the first block, after <tt class="docutils literal"><span class="pre">symbolic-links=0</span></tt> and before
<tt class="docutils literal"><span class="pre">[mysqld_safe]</span></tt> paste the following:</p>
<pre>log-bin = mysql-bin<br />server-id = 1</pre><p>then save and quit (Ctrl-X)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">/etc/init.d/mysqld</span> <span class="pre">restart</span></tt></p>
</li>
</ol>
<p>Now SSH into slavedb and write the following commands:</p>
<ol class="arabic">
<li><p class="first"><tt class="docutils literal"><span class="pre">sudo</span> <span class="pre">su</span> <span class="pre">-</span></tt></p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">nano</span> <span class="pre">/etc/my.cnf</span></tt></p>
</li>
<li><p class="first">at the end of the first block, after <tt class="docutils literal"><span class="pre">symbolic-links=0</span></tt> and before
<tt class="docutils literal"><span class="pre">[mysqld_safe]</span></tt> paste the following):</p>
<pre>log-bin = mysql-bin<br />server-id = 2<br />relay-log = mysql-relay-bin<br />log-slave-updates = 1<br />read-only = 1</pre></li>
<li><p class="first"><tt class="docutils literal"><span class="pre">/etc/init.d/mysqld</span> <span class="pre">restart</span></tt></p>
</li>
</ol>
<p>And back to primarydb:</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">mysqldump</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">-p</span> <span class="pre">--all-databases</span> <span class="pre">--master-data=2</span> <span class="pre">&gt;</span> <span class="pre">dump.db</span></tt></li>
<li>Copy this file to the slave_db instance</li>
</ol>
<p>And back to slavedb:</p>
<ol class="arabic simple">
<li>Go to the directory you copied <tt class="docutils literal"><span class="pre">dump.db</span></tt></li>
<li><tt class="docutils literal"><span class="pre">/etc/init.d/mysqld</span> <span class="pre">restart</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span></tt></li>
<li><tt class="docutils literal"><span class="pre">GRANT</span> <span class="pre">ALL</span> <span class="pre">ON</span> <span class="pre">*.*</span> <span class="pre">TO</span> <span class="pre">root&#64;'%'</span> <span class="pre">IDENTIFIED</span> <span class="pre">BY</span> <span class="pre">'letmein'</span> <span class="pre">WITH</span> <span class="pre">GRANT</span> <span class="pre">OPTION;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">FLUSH</span> <span class="pre">PRIVILEGES;</span></tt> (Then press Ctrl-C to quit MySQL)</li>
<li><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span> <span class="pre">&lt;</span> <span class="pre">dump.db</span></tt></li>
<li><tt class="docutils literal"><span class="pre">mysql</span> <span class="pre">-u</span> <span class="pre">root</span></tt></li>
<li>Now you need to open your local copy of <tt class="docutils literal"><span class="pre">dump.db</span></tt> and search for
<tt class="docutils literal"><span class="pre">MASTER_LOG_FILE</span></tt> and <tt class="docutils literal"><span class="pre">MASTER_LOG_POS</span></tt>, noting their values and
replacing them in the following line:
<tt class="docutils literal"><span class="pre">CHANGE</span> <span class="pre">MASTER</span> <span class="pre">TO</span> <span class="pre">master_host='primarydb',</span> <span class="pre">master_user='root',</span> <span class="pre">master_password='letmein',</span> <span class="pre">master_log_file='mysql-bin.000001',</span> <span class="pre">master_log_pos=106;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">START</span> <span class="pre">SLAVE;</span></tt></li>
</ol>
</div>
</div>
</div>
<div class="section" id="getting-started-virtual-private-cloud-vpc-mode">
<h1>Getting Started: Virtual Private Cloud (VPC) Mode<a class="headerlink" href="#getting-started-virtual-private-cloud-vpc-mode" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview-of-vpc-and-aws-platforms">
<h2>1. Overview of VPC and AWS Platforms<a class="headerlink" href="#overview-of-vpc-and-aws-platforms" title="Permalink to this headline">¶</a></h2>
<p>A Virtual Private Cloud (or VPC) is a virtual network of logically
isolated EC2 instances and an optional VPN connection to your own
datacenter. This allows greater security than the classic EC2 system.
Amazon announced that they are changing to VPC by default to all new
users on a region by region basis.</p>
<p>This means that there are two platforms (EC2-Classic and EC2-VPC) and
scenarios (Previously used regions and never used regions):</p>
<table><tbody><tr><th><p>Had the region been used before this change?</p>
</th>
<th><p>Unspecified VPC</p>
</th>
<th><p>Specified VPC</p>
</th>
</tr><tr><td><p>Yes</p>
</td>
<td><p>EC2-Classic</p>
</td>
<td><p>EC2-VPC (non-default VPC)</p>
</td>
</tr><tr></tr><tr><td><p>No</p>
</td>
<td><p>EC2-VPC (default VPC)</p>
</td>
<td><p>EC2-VPC (non-default VPC)</p>
</td>
</tr></tbody></table><p>Let&#8217;s go through each one:</p>
<div class="section" id="ec2-classic">
<h3>EC2-Classic<a class="headerlink" href="#ec2-classic" title="Permalink to this headline">¶</a></h3>
<p>This is the same as what was previously just called EC2. If your account
was created before AWS made this change and you have previously used the
region (or AWS has not yet made the change in the region) then you will
have the option to use EC2-Classic.</p>
</div>
<div class="section" id="ec2-vpc-non-default-vpc">
<h3>EC2-VPC (non-default VPC)<a class="headerlink" href="#ec2-vpc-non-default-vpc" title="Permalink to this headline">¶</a></h3>
<p>Creating a non-default (custom) VPC is the same as what was previously
just called VPC. No matter when you created your account or if you have
used the region before or not, you will have access to this and there is
no change to creating a custom VPC.</p>
<p>So EC2 is now called EC2-Classic and is restricted to older users and
VPC is now part of EC2-VPC when a custom VPC is created and is available
to everyone. So what&#8217;s new?</p>
</div>
<div class="section" id="ec2-vpc-default-vpc">
<h3>EC2-VPC (default VPC)<a class="headerlink" href="#ec2-vpc-default-vpc" title="Permalink to this headline">¶</a></h3>
<p>EC2-VPC now has a default VPC which replaces EC2-Classic for new
users/regions. It has all the ease of use of EC2-Classic but instead
your resources will be launched in to your own logically isolated VPC.
This means you automatically get improved security and are able to use
VPC only features like security group ingress rules, multiple IP
address, elastic network interfaces and more. You can learn more about
the differences between the two platforms in the AWS docs.</p>
<p>Madeira will automatically detect which platforms your currently
selected region supports and if you have a default VPC. If required, you
will be prompted to select a platform when creating a Stack.</p>
</div>
<div class="section" id="stack-restrictions">
<h3>Stack Restrictions:<a class="headerlink" href="#stack-restrictions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>You cannot mix EC2-Classic and EC2-VPC resources in the same Stack</li>
<li>A Stack can only contain one VPC (default or custom)</li>
<li>Do not delete your default VPC in the AWS Console or you will only be
able to create custom VPCs in the AWS Console and Madeira</li>
<li>Deleting or heaviy modifying default subnets or VPC nodes in the AWS
Console will likely cause issues when using the EC2-VPC Default VPC
in Madeira</li>
</ul>
</div>
</div>
<div class="section" id="step-by-step-tutorials">
<h2>2. Step-by-step tutorials<a class="headerlink" href="#step-by-step-tutorials" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="vpc-with-a-public-subnet-only">
<h2>2.1 VPC with a Public Subnet Only<a class="headerlink" href="#vpc-with-a-public-subnet-only" title="Permalink to this headline">¶</a></h2>
<p>Description: &#8220;The configuration for this scenario includes a virtual
private cloud (VPC) with a single public subnet, and an Internet gateway
to enable communication over the Internet. We recommend this
configuration if you need to run a single-tier, public-facing web
application, such as a blog or a simple website.&#8221;</p>
<p>The following diagram shows what we will create in this example:
<img alt="image23" src="vpc_stack.png" /></p>
<p>Step by Step guide to configuring a VPC with a Public Subnet (you may
want to have a look at the Classic mode - Part 1. tutorial first, before
creating a VPC)</p>
<ol class="arabic simple">
<li>Create a new VPC Stack, in the region of your choice: <img alt="image24" src="vpc_region.png" /><img alt="image25" src="vpc_select_stack.png" /></li>
<li>A default VPC is created when you create a new VPC Stack, as well as
a default Route Table. You can optionaly edit the subnet details in
the right pannel (don&#8217;t forget to focus on the subnet by clicking on
its blank area). The network address must be written following the
CIDR notation: <img alt="image26" src="vpc_default.png" /></li>
<li>You can now add a new Availability Zone of your choice by drag-n-drop
it from the left pannel: <img alt="image27" src="vpc_az.png" /></li>
<li>When adding a new Availability Zone, a default subnet is created. You
can edit the subnet properties in the right pannel: <img alt="image28" src="vpc_edit_subnet.png" /> Note
that all Subnets are automatically connected to the Main Route Table.
Subnets must be connected to only one Route Table.</li>
<li>Add an Internet Gateway and connect it to the Route Table Drag an IGW
from the resource panel (VPC category) to anywhere within the VPC.
Note that the IGW will automatically snap to the left edge of the VPC
and you can only have one IGW per VPC. <img alt="image29" src="vpc_igw.png" /></li>
<li>You can now drag from the blue ports on the Route Table to the blue
incoming port on the IGW to connect it. <img alt="image30" src="vpc_igw_rt.png" /></li>
<li>You can edit the Route Table properties to define routing rules on
the right pannel after selecting it. Note that when you connect an RT
to an IGW we will automatically add a destination &#8220;0.0.0.0/0&#8221; rule.
<img alt="image31" src="vpc_edit_rt.png" /></li>
</ol>
<div class="section" id="optionally">
<h3>Optionally<a class="headerlink" href="#optionally" title="Permalink to this headline">¶</a></h3>
<p>You can stop there and save the Stack as a networking template or we can
continue and launch it as an App.</p>
<ol class="arabic simple">
<li>Add an AMI to a Subnet We can now drag on an AMI from the resource
panel to inside the Subnet in our VPC. <img alt="image32" src="vpc_add_ami.png" /></li>
<li>Add an Elastic IP Next click on the bottom-right icon of the instance
to attach an EIP. <img alt="image33" src="vpc_add_eip.png" /></li>
</ol>
<p>Your VPC is now configured. Please, have a look at the Classic mode -
Part 1. tutorial to get more information about App creation.</p>
</div>
</div>
<div class="section" id="vpc-with-public-and-private-subnets">
<h2>2.2 VPC with Public and Private Subnets<a class="headerlink" href="#vpc-with-public-and-private-subnets" title="Permalink to this headline">¶</a></h2>
<p>Description: &#8220;The configuration for this scenario includes a virtual
private cloud (VPC) with a public subnet and a private subnet. The
instances in the public subnet can receive inbound traffic directly from
the Internet, whereas the instances in the private subnet can&#8217;t. The
instances in the public subnet can send outbound traffic directly to the
Internet, whereas the instances in the private subnet can&#8217;t. Instead,
the instances in the private subnet can access the Internet by using a
network address translation (NAT) instance that you launch into the
public subnet.&#8221;</p>
<p>The following diagram shows what we will create in this example:
<img alt="image34" src="vpc_stack_pr.png" /></p>
<p>Step by Step guide to configuring a VPC with Public and Private Subnets
(you may want to have a look at the VPC Mode - VPC with a Public Subnet
Only - Part 2.2.1 tutorial first, before creating this VPC.</p>
<ol class="arabic">
<li><p class="first">Create a new VPC Stack, in the region of your choice: <img alt="image35" src="vpc_region.png" /><img alt="image36" src="vpc_select_stack.png" /></p>
</li>
<li><p class="first">A default VPC is created when you create a new VPC Stack, as well as
a default Route Table. You can optionaly edit the subnet details in
the right pannel (don&#8217;t forget to focus on the subnet by clicking on
its blank area). The network address must be written following the
CIDR notation: <img alt="image37" src="vpc_default.png" /></p>
</li>
<li><p class="first">You can now add a new Availability Zone of your choice by
drag-n-drop it from the left pannel: <img alt="image38" src="vpc_az.png" /></p>
</li>
<li><p class="first">When adding a new Availability Zone, a default subnet is created.
You can edit the subnet properties in the right pannel <img alt="image39" src="vpc_edit_subnet.png" />Note that all Subnets are automatically connected to the Main Route
Table. Subnets must be connected to only one Route Table.</p>
</li>
<li><p class="first">Add another subnet by dragging it from the resources pannel and
dropping it in the Availability Zone. Name one subnet &#8220;public&#8221; with
the CIDR IP &#8220;10.0.0.0/24&#8221; and the other &#8220;private&#8221; with the CIDR IP
&#8220;10.0.1.0/24&#8221; as following: <img alt="image40" src="vpc_edit_subnet_pr.png" /></p>
</li>
<li><p class="first">Add an Internet Gateway and connect it to the Route Table Drag an
IGW from the resource panel (VPC category) to anywhere within the
VPC. Note that the IGW will automatically snap to the left edge of
the VPC and you can only have one IGW per VPC. Then, drag from the
blue ports on the Route Table to the blue incoming port on the IGW
to connect it. <img alt="image41" src="vpc_rt_pr.png" /></p>
</li>
<li><p class="first">You can click on the Route Table to define routing rules. Note that
when you connect an RT to an IGW we will automatically add a
destination &#8220;0.0.0.0/0&#8221; rule. <img alt="image42" src="vpc_rt_prop.png" /></p>
</li>
<li><p class="first">Add another Route Table Drag another RT from the resource panel to
anywhere in the VPC. We can then associate subnet &#8220;private&#8221; to this
RT by dragging from the grey port on the right of the subnet to an
incoming grey port on the RT. Note that, as subnets can only be
associated with one RT, the previous association will automatically
be removed. <img alt="image43" src="vpc_add_rt.png" /></p>
</li>
<li><p class="first">Add the AMIs to the Subnets We can now drag on some AMIs from the
resource panel to inside the Subnets in our VPC. Let&#8217;s start by
dragging two 64 bit Amazon Linux AMIs, one to each subnet.
Optionally, click on the instances to rename the hosts in the right
pannel. <img alt="image44" src="vpc_ami_pr.png" /> Also add a NAT instance to the &#8220;public&#8221; subnet.
You can find a Amazon Linux NAT AMI in the Quickstart AMIs. Drag it
to the public subnet and name it &#8220;NAT&#8221;. <img alt="image45" src="vpc_nat_pr.png" /></p>
</li>
<li><p class="first">Connect the NAT and configure the RT Connect the RT to the NAT AMI
by dragging from its outgoing blue port to the incoming blue port on
the left of the NAT AMI. Enter &#8220;0.0.0.0/0&#8221; as &#8220;Destination&#8221; in the
right pannel. <img alt="image46" src="vpc_rt2_pr.png" /></p>
</li>
<li><p class="first">Configure the AMI IPs Click an AMI and select &#8220;Network Interface
Details&#8221; in the right pannel. Here you can manually specify the IP
address within the subnet range (&#8221;.x&#8221; means auto assign random IP)
and click the icon on the right to add an Elastic IP to a private
IP. <img alt="image47" src="vpc_net_pr.png" /> Go ahead and use the following IP configurations:</p>
<table>
<tbody><tr><th><p>Subnet</p>
</th>
<th><p>Host</p>
</th>
<th><p>Private IP</p>
</th>
<th><p>Elastic IP</p>
</th>
</tr><tr><td><p>public</p>
</td>
<td><p>NAT</p>
</td>
<td><p>10.0.0.x</p>
</td>
<td><p>Yes</p>
</td>
</tr><tr><td><p>public</p>
</td>
<td><p>public</p>
</td>
<td><p>10.0.0.5</p>
</td>
<td><p>Yes</p>
</td>
</tr><tr><td><p>private</p>
</td>
<td><p>private</p>
</td>
<td><p>10.0.1.5</p>
</td>
<td><p>No</p>
</td>
</tr></tbody>
</table></li>
<li><p class="first">Create and Configure Security Groups for each AMI Click an AMI and
select &#8220;Security Groups&#8221; on the right pannel. Here you can create
some new Security groups. Configure the Security Groups as
following:</p>
<table><tbody><tr><th><p>AMI</p>
</th>
<th><p>SG Name</p>
</th>
</tr><tr><td><p>NAT</p>
</td>
<td><p>NATSG</p>
</td>
</tr><tr><td><p>public</p>
</td>
<td><p>WebServerSG</p>
</td>
</tr><tr><td><p>private</p>
</td>
<td><p>DBServerSG</p>
</td>
</tr></tbody></table><p>You can now add the following rules to the Security Groups (see the
Classic mode - Part 1. tutorial before to know how to create
Security Rules):</p>
<table><tbody><tr><td rowspan="2"><p>SG</p>
</td>
<td rowspan="2"><p>AMI</p>
</td>
<td colspan="4"><p>Security Group Rules</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>In / Out</p>
</td>
<td><p>Soure / Dest</p>
</td>
<td><p>Protocol</p>
</td>
<td><p>Port Range</p>
</td>
</tr><tr><td rowspan="8"><p>WebServerSG</p>
</td>
<td rowspan="8"><p>public</p>
</td>
<td rowspan="4" style="border-left: 1px solid gray;"><p>In</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr><td><p>Your network’s public IP address range</p>
</td>
<td><p>TCP</p>
</td>
<td><p>22</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>Your network’s public IP address range</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3389</p>
</td>
</tr><tr><td rowspan="4" style="border-left: 1px solid gray;"><p>Out</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr><td><p>private.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>1433</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>private.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3306</p>
</td>
</tr><tr><td rowspan="4"><p>DBServerSG</p>
</td>
<td rowspan="4"><p>private</p>
</td>
<td rowspan="2" style="border-left: 1px solid gray;"><p>In</p>
</td>
<td><p>public.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>1433</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>public.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3306</p>
</td>
</tr><tr><td rowspan="2" style="border-left: 1px solid gray;"><p>Out</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr><td rowspan="5"><p>NATSG</p>
</td>
<td rowspan="5"><p>NAT</p>
</td>
<td rowspan="3" style="border-left: 1px solid gray;"><p>In</p>
</td>
<td><p>10.0.1.0/24</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>10.0.1.0/24</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>Your network’s public IP address range</p>
</td>
<td><p>TCP</p>
</td>
<td><p>22</p>
</td>
</tr><tr><td rowspan="2" style="border-left: 1px solid gray;"><p>Out</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr></tbody></table></li>
</ol>
</div>
<div class="section" id="vpc-with-public-and-private-subnets-and-hardware-vpn-access">
<h2>2.3 VPC with Public and Private Subnets and Hardware VPN Access<a class="headerlink" href="#vpc-with-public-and-private-subnets-and-hardware-vpn-access" title="Permalink to this headline">¶</a></h2>
<p>Description: “The configuration for this scenario includes a virtual
private cloud (VPC) with a public subnet and a private subnet, and a
virtual private gateway to enable communication with your own network
over an IPsec VPN tunnel. We recommend this scenario if you want to
extend your network into the cloud and also directly access the Internet
from your VPC. This scenario enables you to run a multi-tiered
application with a scalable web front end in a public subnet, and to
house your data in a private subnet that is connected to your network by
an IPsec VPN connection.”</p>
<p>The following diagram shows what we will create in this example:
<img alt="image48" src="vpc_stack_prhw.png" /></p>
<p>Step by Step guide to configuring a VPC with Public Subnet and Private
Subnets and Hardware VPN Access (you may want to have a look at the VPC
Mode - VPC with Public and Private Subnets - Part 2.2.2 tutorial first,
before creating this VPC.</p>
<ol class="arabic">
<li><p class="first">Create a new VPC Stack, in the region of your choice: <img alt="image49" src="vpc_region.png" /><img alt="image50" src="vpc_select_stack.png" /></p>
</li>
<li><p class="first">A default VPC is created when you create a new VPC Stack, as well as
a default Route Table. You can optionaly edit the subnet details in
the right pannel (don&#8217;t forget to focus on the subnet by clicking on
its blank area). The network address must be written following the
CIDR notation: <img alt="image51" src="vpc_default.png" /></p>
</li>
<li><p class="first">You can now add a new Availability Zone of your choice by
drag-n-drop it from the left pannel: <img alt="image52" src="vpc_az.png" /></p>
</li>
<li><p class="first">When adding a new Availability Zone, a default subnet is created.
You can edit the subnet properties in the right pannel <img alt="image53" src="vpc_edit_subnet.png" />Note that all Subnets are automatically connected to the Main Route
Table. Subnets must be connected to only one Route Table.</p>
</li>
<li><p class="first">Add another subnet by dragging it from the resources pannel and
dropping it in the Availability Zone. Name one subnet &#8220;public&#8221; with
the CIDR IP &#8220;10.0.0.0/24&#8221; and the other &#8220;private&#8221; with the CIDR IP
&#8220;10.0.1.0/24&#8221; as following: <img alt="image54" src="vpc_edit_subnet_pr.png" /></p>
</li>
<li><p class="first">Add an Internet Gateway and connect it to the Route Table Drag an
IGW from the resource panel (VPC category) to anywhere within the
VPC. Note that the IGW will automatically snap to the left edge of
the VPC and you can only have one IGW per VPC. Then, drag from the
blue ports on the Route Table to the blue incoming port on the IGW
to connect it. <img alt="image55" src="vpc_rt_pr.png" /></p>
</li>
<li><p class="first">You can click on the Route Table to define routing rules. Note that
when you connect an RT to an IGW we will automatically add a
destination &#8220;0.0.0.0/0&#8221; rule. <img alt="image56" src="vpc_rt_prop.png" /></p>
</li>
<li><p class="first">Add another Route Table Drag another RT from the resource panel to
anywhere in the VPC. We can then associate subnet &#8220;private&#8221; to this
RT by dragging from the grey port on the right of the subnet to an
incoming grey port on the RT. Note that, as subnets can only be
associated with one RT, the previous association will automatically
be removed. <img alt="image57" src="vpc_add_rt.png" /></p>
</li>
<li><p class="first">Add a Virtual Private Gateway and Connect it to the Route Table Drag
a VGW in to the VPC. Note that it will snap to the right side of the
VPC. Once added, connect the left blue port of the VGW to the blue
incoming port of the RT associated with the Private subnet. The RT
configuration dialogue will automatically appear. Enter the
Destination &#8220;172.16.0.0/12&#8221; in the right pannel. <img alt="image58" src="vpc_vgw.png" /></p>
</li>
<li><p class="first">Add a Customer Gateway Drag a CGW to the canvas. Note that it must
be outside the VPC. After have added the CGW you must enter the IP
address of your CGW, e.g., &#8220;203.0.113.12&#8221;. You can rename it as you
wish. <img alt="image59" src="vpc_cgw.png" /></p>
</li>
<li><p class="first">Connect the CGW and VGW with a VPN Connection Connect the purple
ports of the VGW and CGW to create a VPN. You must enter your VPN
CIDR, e.g., &#8220;172.16.0.0/24&#8221;, in the right pannel. <img alt="image60" src="vpc_cgw_vpn.png" /></p>
</li>
<li><p class="first">Add AMIs to the Subnets Drag in some AMIs to the Subnets and rename
them. <img alt="image61" src="vpc_vpn_ami.png" /></p>
</li>
<li><p class="first">Create and Configure Security Groups for each AMI Click an AMI and
select &#8220;Security Groups&#8221; in the right pannel. Here you can create a
custom SG for each AMI and remove them from &#8220;Default SG&#8221;.
<img alt="image62" src="vpc_vpn_sg.png" /></p>
</li>
<li><p class="first">Connect the AMIs and Configure the Security Groups You can define
the Security Rules in each SG properties. Define it as follow:</p>
<table><tbody><tr><td rowspan="2"><p>SG</p>
</td>
<td rowspan="2"><p>AMI</p>
</td>
<td colspan="4"><p>Security Group Rules</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>In / Out</p>
</td>
<td><p>Soure / Dest</p>
</td>
<td><p>Protocol</p>
</td>
<td><p>Port Range</p>
</td>
</tr><tr><td rowspan="8"><p>WebServerSG</p>
</td>
<td rowspan="8"><p>WebServer</p>
</td>
<td rowspan="4" style="border-left: 1px solid gray;"><p>In</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr><td><p>Your network’s public IP address range</p>
</td>
<td><p>TCP</p>
</td>
<td><p>22</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>Your network’s public IP address range</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3389</p>
</td>
</tr><tr><td rowspan="4" style="border-left: 1px solid gray;"><p>Out</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr><tr><td><p>DBServer.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>1433</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>DBServer.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3306</p>
</td>
</tr><tr><td rowspan="6"><p>DBServerSG</p>
</td>
<td rowspan="6"><p>DBServer</p>
</td>
<td rowspan="4" style="border-left: 1px solid gray;"><p>In</p>
</td>
<td><p>WebServer.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>1433</p>
</td>
</tr><tr><td><p>WebServer.private_ip_address</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3306</p>
</td>
</tr><tr><td><p>172.16.0.0/24</p>
</td>
<td><p>TCP</p>
</td>
<td><p>22</p>
</td>
</tr><tr style="border-bottom: 1px solid gray;"><td><p>172.16.0.0/24</p>
</td>
<td><p>TCP</p>
</td>
<td><p>3389</p>
</td>
</tr><tr><td rowspan="2" style="border-left: 1px solid gray;"><p>Out</p>
</td>
<td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>80</p>
</td>
</tr><tr><td><p>0.0.0.0/0</p>
</td>
<td><p>TCP</p>
</td>
<td><p>443</p>
</td>
</tr></tbody></table></li>
<li><p class="first">Configure DHCP Options Set You can edit the VPC properties to
configure DHCP in the right pannel. <img alt="image63" src="vpc_vpn_dhcp.png" /></p>
</li>
</ol>
</div>
<div class="section" id="vpc-with-a-private-subnet-only-and-hardware-vpn-access">
<h2>2.4 VPC with a Private Subnet Only and Hardware VPN Access<a class="headerlink" href="#vpc-with-a-private-subnet-only-and-hardware-vpn-access" title="Permalink to this headline">¶</a></h2>
<p>Description: “The configuration for this scenario includes a virtual
private cloud (VPC) with a single private subnet, and a virtual private
gateway to enable communication with your own network over an IPsec VPN
tunnel. There is no Internet gateway to enable communication over the
Internet. We recommend this scenario if you want to extend your network
into the cloud using Amazon&#8217;s infrastructure without exposing your
network to the Internet.”</p>
<p>The following diagram shows what we will create in this example:
<img alt="image64" src="vpc_stack_prohw.png" /></p>
<p>Step by Step guide to configuring a VPC with a Private Subnet Only and
Hardware VPN Access (you may want to have a look at the VPC Mode - VPC
with Public and Private Subnets and Hardware VPN Access - Part 2.2.3
tutorial first, before creating this VPC.</p>
<ol class="arabic simple">
<li>Create a new VPC Stack, in the region of your choice: <img alt="image65" src="vpc_region.png" /><img alt="image66" src="vpc_select_stack.png" /></li>
<li>A default VPC is created when you create a new VPC Stack, as well as
a default Route Table. You can optionaly edit the subnet details in
the right pannel (don&#8217;t forget to focus on the subnet by clicking on
its blank area). The network address must be written following the
CIDR notation: <img alt="image67" src="vpc_default.png" /></li>
<li>You can now add a new Availability Zone of your choice by drag-n-drop
it from the left pannel: <img alt="image68" src="vpc_az.png" /></li>
<li>When adding a new Availability Zone, a default subnet is created. You
can edit the subnet properties in the right pannel: <img alt="image69" src="vpc_edit_subnet.png" /> Note
that all Subnets are automatically connected to the Main Route Table.
Subnets must be connected to only one Route Table.</li>
<li>Add a Virtual Private Gateway and Connect it to the Route Table Drag
a VGW in to the VPC. Note that it will snap to the right side of the
VPC. Once added, connect the left blue port of the VGW to the blue
incoming port of the RT. Then, enter the Destination &#8220;0.0.0.0/0&#8221; in
the right pannel. <img alt="image70" src="vpc_vpn_pro.png" /></li>
<li>Add a Customer Gateway Drag a CGW to the canvas. Note that it must be
outside the VPC. After have added the CGW you must enter the IP
address of your CGW, e.g., &#8220;203.0.113.12&#8221;. You can rename it as you
wish. <img alt="image71" src="vpc_cgw_pro.png" /></li>
<li>Connect the CGW and VGW with a VPN Connection Connect the purple
ports of the VGW and CGW to create a VPN. You must enter your VPN
CIDR, e.g., &#8220;172.16.0.0/24&#8221;, in the right pannel. <img alt="image72" src="vpc_cgw_vpn_pro.png" /></li>
</ol>
</div>
</div>
<div class="section" id="ide-interface">
<h1>IDE interface<a class="headerlink" href="#ide-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="global-details">
<h2>1 Global details<a class="headerlink" href="#global-details" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="description">
<h2>1.1 Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p><img alt="image73" src="ide_full.png" /> MadeiraCloud IDE is a What You See Is What You Get editor
for cloud applications. In other words, the project enables system
architects to draw their infrastructure instead of writing it, reducing
the time taken to design, provision, configure and connect distributed
cloud resources.</p>
<p>The IDE is composed of three different screens:</p>
<ul class="simple">
<li>The dashboard</li>
<li>The Stack edition</li>
<li>The App monitoring</li>
</ul>
<p>We will go through each of them in the following parts.</p>
</div>
<div class="section" id="userbar">
<h2>1.2 Userbar<a class="headerlink" href="#userbar" title="Permalink to this headline">¶</a></h2>
<p><img alt="image74" src="ide_userbar.png" /> The userbar is located on the top right of the IDE.</p>
<p>This bar has two main menus:</p>
<ul class="simple">
<li>The &#8220;alert&#8221; menu, aimed to list all the different alert/news/events
<img alt="image75" src="ide_userbar_alert.png" /></li>
<li>The &#8220;user&#8221; menu, aimed to list the different user parameters
<img alt="image76" src="ide_userbar_menu.png" /></li>
</ul>
</div>
<div class="section" id="dashboard">
<h2>2. Dashboard<a class="headerlink" href="#dashboard" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id1">
<h2>2.1 Description<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p><img alt="image77" src="ide_dashboard_all.png" /> The dashboard is a control center where you can control both
your Madeira activiry and your AWS account activity and resources.</p>
<div class="section" id="access">
<h3>Access<a class="headerlink" href="#access" title="Permalink to this headline">¶</a></h3>
<p>To access the dashboard, simply login to the IDE, or, at any point, you
can go back to the dashboard by clicking on the first icon on the left
menubar, then selecting the region of your choice. <img alt="image78" src="ide_dashboard_access.png" /></p>
</div>
<div class="section" id="stack-creation-button">
<h3>Stack creation button<a class="headerlink" href="#stack-creation-button" title="Permalink to this headline">¶</a></h3>
<p>A &#8220;Create new Stack&#8221; has been implemented to help you creating new
Stacks with MadeiraCloud IDE. You can find it on the tol left of the
dashboard. Please, go through Classic mode - Part 1. tutorial to learn
how to create a Stack. <img alt="image79" src="ide_dashboard_newstack.png" /></p>
</div>
</div>
<div class="section" id="main-view">
<h2>2.2 Main view<a class="headerlink" href="#main-view" title="Permalink to this headline">¶</a></h2>
<p><img alt="image80" src="ide_dashboard_main.png" /> The &#8220;Main View&#8221; is the top view of the dashboard, showing
the number of App and Stack in every AWS region. The &#8220;Main View&#8221; is
always displayed in the dashboard.</p>
</div>
<div class="section" id="global-dashboard">
<h2>2.3 Global Dashboard<a class="headerlink" href="#global-dashboard" title="Permalink to this headline">¶</a></h2>
<p><img alt="image81" src="ide_dashboard_global.png" /> The global Dashboard is an overview of the costful AWS
resources in all AWS regions. This view helps to quickly determine which
resources are currently in use and would cost money.</p>
<p>You can see there:</p>
<ul class="simple">
<li>Running Instances</li>
<li>Elastic IPs</li>
<li>Volumes (EBS)</li>
<li>Load Balancers (ELB)</li>
<li>VPNs</li>
</ul>
<p>note: VPCs are not costful, however, VPN connections to VPCs are.</p>
</div>
<div class="section" id="region-specific-dashboard">
<h2>2.4 Region specific Dashboard<a class="headerlink" href="#region-specific-dashboard" title="Permalink to this headline">¶</a></h2>
<p><img alt="image82" src="ide_dashboard_region.png" /> The region specific Dashboard is an overview of different
resources in a specific region.</p>
<p>This view is separated in two parts:</p>
<ul class="simple">
<li>The App/Stack view: You can see here the App and Stack created in
this specific region using MadeiraCloud IDE</li>
<li>The AWS resources view: You can see here the details of the most
relevent AWS resources, wether or not created with MadeiraCloud IDE</li>
</ul>
<div class="section" id="details">
<h3>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h3>
<p>You can get more details about a specific resource by clicking on the
&#8220;Detail&#8221; icon, on the right of each resource. This will display you all
the needed information about this resource.</p>
<p>For example, for an instance: <img alt="image83" src="ide_dashboard_ami.png" /></p>
</div>
</div>
<div class="section" id="stack-edition">
<h2>3. Stack edition<a class="headerlink" href="#stack-edition" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="id2">
<h2>3.1 Description<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><img alt="image84" src="ide_stack_all.png" /> The Stack screen is where you design your Cloud
infrstructure.</p>
<div class="section" id="composition">
<h3>Composition<a class="headerlink" href="#composition" title="Permalink to this headline">¶</a></h3>
<p>The Stack edition screen is mainly composed of four areas:</p>
<ul class="simple">
<li>The resources pannel on the left</li>
<li>The property pannel on the right</li>
<li>The edition canvas in the middle</li>
<li>The tool bar on the top</li>
</ul>
</div>
<div class="section" id="id3">
<h3>Access<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>To access the Stack edition screen, you can either create a new Stack or
edit an already existing one. Simply click on any of the Stack creation
button to create a new one, or click on the second icon on the left
menubar, then select the Stack of your choice to edit an already
existing Stack. <img alt="image85" src="ide_stack_access.png" /></p>
</div>
</div>
<div class="section" id="resources">
<h2>3.2 Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="availability-zones">
<h2>3.2.1 Availability Zones<a class="headerlink" href="#availability-zones" title="Permalink to this headline">¶</a></h2>
<p><img alt="image86" src="ide_stack_az.png" /> The Availability Zones are the location of your resources on
AWS, specific to each region.</p>
<p>You can switch to any other available AZ on the right pannel before
running the Stack.</p>
</div>
<div class="section" id="images">
<h2>3.2.2 Images<a class="headerlink" href="#images" title="Permalink to this headline">¶</a></h2>
<p><img alt="image87" src="ide_stack_ami.png" /> The Images represent the EC2 Instances with the AMI of your
choice.</p>
<p>You can edit the Instance/AMI properties in the right pannel. Note a
field &#8220;Number of Instance&#8221;, aimed to create groups of identical
Instances (e.g. clustering).</p>
<div class="section" id="images-source">
<h3>Images source<a class="headerlink" href="#images-source" title="Permalink to this headline">¶</a></h3>
<p>You can select the AMIs source on the resources pannel. <img alt="image88" src="ide_stack_ami_menu.png" /></p>
<p>You can either get an AMI from the community by clicking in the &#8220;Browse
Community Images&#8221; button. <img alt="image89" src="ide_stack_ami_community.png" /></p>
</div>
</div>
<div class="section" id="volume-and-snapshots">
<h2>3.2.3 Volume and Snapshots<a class="headerlink" href="#volume-and-snapshots" title="Permalink to this headline">¶</a></h2>
<p><img alt="image90" src="ide_stack_volume.png" /> The Volumes are some additional drives that you can add to
your instances in order to enhance the storage capacity. The Snapshots
describe a state of a device at a precise moment.</p>
<p>To attach a Volume to an Instance, simply drag it from the Resources
pannel, then drop it on an instance. You can then configure the Volume
in the right pannel.</p>
</div>
<div class="section" id="load-balancer-and-auto-scaling">
<h2>3.2.4 Load Balancer and Auto Scaling<a class="headerlink" href="#load-balancer-and-auto-scaling" title="Permalink to this headline">¶</a></h2>
<div class="section" id="load-balancers">
<h3>Load Balancers<a class="headerlink" href="#load-balancers" title="Permalink to this headline">¶</a></h3>
<p><img alt="image91" src="ide_stack_elb.png" /> The Load Balancers (ELB) are some pre-configured instances
automatically distributing the incomming traffric accross multiple EC2
Instances.</p>
<p>Simply drag a load balancer from the Resources pannel then drop it
outside of the Availability Zones. You can then link the load balancer
to the instances. You can configure the load balances on the right
pannel.</p>
</div>
<div class="section" id="auto-scaling-groups">
<h3>Auto Scaling Groups<a class="headerlink" href="#auto-scaling-groups" title="Permalink to this headline">¶</a></h3>
<p><img alt="image92" src="ide_stack_autoscaling.png" /> The Auto Scaling Groups are some containers with an
automatically set number of instances.</p>
<p>Once the group placed inside an Availability Zone, you can drag and drop
an AMI inside to define the type of instance to scale. You can then
configure the Autoscaling Group in the right pannel.</p>
</div>
</div>
<div class="section" id="eips">
<h2>3.2.5 EIPs<a class="headerlink" href="#eips" title="Permalink to this headline">¶</a></h2>
<p><img alt="image93" src="ide_stack_eip.png" /> The EIPs are some static public IP address that you can
associate to any instance/network card.</p>
<p>To activate an EIP, click on the bottom right icon of an instance in
order to make it colored.</p>
</div>
<div class="section" id="virtual-private-cloud-vpc-stack-only">
<h2>3.2.6 Virtual Private Cloud (VPC Stack only)<a class="headerlink" href="#virtual-private-cloud-vpc-stack-only" title="Permalink to this headline">¶</a></h2>
<p><img alt="image94" src="ide_stack_vpc.png" /> A VPC is a virtual private network within a cloud
infrastructure, isolating the resources from the internet.</p>
<p>You can access the global VPC properties in the right pannel.</p>
<div class="section" id="subnet">
<h3>Subnet<a class="headerlink" href="#subnet" title="Permalink to this headline">¶</a></h3>
<p><img alt="image95" src="ide_stack_vpc_subnet.png" /> A subnet is, as its name implies, an isolated network inside
a VPC. You must set here the subnet CIDR block. You can define as well
some ACL rules.</p>
</div>
<div class="section" id="route-table">
<h3>Route Table<a class="headerlink" href="#route-table" title="Permalink to this headline">¶</a></h3>
<p><img alt="image96" src="ide_stack_vpc_rt.png" /> A Route Table is a table gathering the different routes
associated to a subnet.</p>
</div>
<div class="section" id="internet-gateway">
<h3>Internet Gateway<a class="headerlink" href="#internet-gateway" title="Permalink to this headline">¶</a></h3>
<p><img alt="image97" src="ide_stack_vpc_igw.png" /> An Internet Gateway makes the link between the Internet and
the Route Tables.</p>
</div>
<div class="section" id="virtual-gateway">
<h3>Virtual Gateway<a class="headerlink" href="#virtual-gateway" title="Permalink to this headline">¶</a></h3>
<p><img alt="image98" src="ide_stack_vpc_vpn.png" /> A Virtual Gateway makes the link between a private VPN and
the Route Tables.</p>
</div>
<div class="section" id="customer-gateway">
<h3>Customer Gateway<a class="headerlink" href="#customer-gateway" title="Permalink to this headline">¶</a></h3>
<p><img alt="image99" src="ide_stack_vpc_cgw.png" /> A Customer Gateway is an indication of an external gateway
owned by you (VPN endpoint). You must add the CGW ip address in the
properties pannel.</p>
<p>When you link a VGW to a CGW, you must define the network prefix in the
properties pannel. <img alt="image100" src="ide_stack_vpc_cgw-vpn.png" /></p>
</div>
<div class="section" id="network-interface">
<h3>Network Interface<a class="headerlink" href="#network-interface" title="Permalink to this headline">¶</a></h3>
<p><img alt="image101" src="ide_stack_vpc_net.png" /> A Network Interface is an additional network card that you
can add to any instance. You can link the card to any instance and set
the network properties in the right pannel.</p>
</div>
</div>
<div class="section" id="top-menu-bar">
<h2>3.3 Top menu bar<a class="headerlink" href="#top-menu-bar" title="Permalink to this headline">¶</a></h2>
<p><img alt="image102" src="ide_stack_topbar.png" /> The topbar provides the basical actions during the Stack
edition:</p>
<ul class="simple">
<li>Run the Stack</li>
<li>Save the Stack</li>
<li>Delete the Stack</li>
<li>Duplicate the Stack</li>
<li>Create a new Stack</li>
<li>Zoom in</li>
<li>Zoom out</li>
<li>Export (as png or json)</li>
<li>Security Group rules links display</li>
</ul>
</div>
<div class="section" id="security">
<h2>3.4 Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="security-groups">
<h2>3.4.1 Security Groups<a class="headerlink" href="#security-groups" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id4">
<h3>Description<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>A Security Group is a simplified packet-filtering firewall, helping you
to controll the traffic through your infrastructure.</p>
<p>Note that this basic level security is a first and mandatory step to
make an infrastructure secure. However, it must not be considered as a
sufficient security to build a secure infrastructure. Please, start by
reading this article, for example, if you would like to know more about
firewalling and security.</p>
<p>A Security Group is composed of one or more instance(s), and a set of
rules. The rules can filter the incomming traffic (all Stacks) and
outgoing traffic (VPC Stacks only).</p>
<p>The rules can defined as following:</p>
<ul class="simple">
<li>Incomming/Outgoing traffic</li>
<li>Source (incomming) or destination (outgoing) IP address or range
(CIDR notation, 0.0.0.0/0 for all)</li>
<li>Source or destination port number or range (1-65535 for all)</li>
<li>Protocol (TCP, UDP or ICMP)</li>
</ul>
<p>The following instructions has been realized using a VPC Stack. For a
normal Stack, the instructions should be similar, however, remember that
it is not possible to define outgoing rules in normal Stacks, and we
recommand you to setup your own firewall on every instance when using
the normal Stacks.</p>
</div>
<div class="section" id="default-security-group">
<h3>Default Security Group<a class="headerlink" href="#default-security-group" title="Permalink to this headline">¶</a></h3>
<p>A default Security Group is automatically generated when creating a new
Stack. All instance added to this Stack will automatically be placed in
this Security Group.</p>
<p>You can find and edit the Security Groups in the Stack or the instances
properties (right pannel).</p>
<div class="figure">
<img alt="" src="ide_stack_sgedit.png" />
</div>
<p>The Default Security Group already contains one rule, allowing all
incomming TCP traffic on port 22 (SSH). This rule is mandatory if you
want to manage your instance. However, you can reduce the IP range if
you want to limit the users who can manage your instance.</p>
</div>
<div class="section" id="create-a-custom-security-group">
<h3>Create a custom Security Group<a class="headerlink" href="#create-a-custom-security-group" title="Permalink to this headline">¶</a></h3>
<p>If you want to establish different rules for your instances, you need to
create some custom Security Groups. You can them define, for each of
them, the outgoing and incoming rules.</p>
<p>To create a custom Security Group, you can click on &#8220;Create new Security
Group&#8221; just under the Security Groups list (instance or Stack
properties, right pannel).</p>
<p>You will be automatically redirected to the rules definition pannel.
Jump two topics ahead if you want to define your rules now, or go back,
follow this tutorial and define it later.</p>
<p>We create two custom Security Groups for this example.</p>
<div class="figure">
<img alt="" src="ide_stack_sgcust.png" />
</div>
</div>
<div class="section" id="associate-a-custom-security-group">
<h3>Associate a custom Security Group<a class="headerlink" href="#associate-a-custom-security-group" title="Permalink to this headline">¶</a></h3>
<p>Once the custom Security Groups created, you can now add the instances
inside the Security Groups. To do so, go on each instance properties,
then Security Groups, tick the security group of your choice, then
untick the DefaultSG.</p>
<p>You should see the colored square on the bottom left of your instance
changing, according to the Security Group you are using. Note that an
instance can be in several security groups (including the DefaultSG).
See AWS Security Groups documentation for more details about Security
Groups themselves.</p>
<div class="figure">
<img alt="" src="ide_stack_sginst.png" />
</div>
</div>
<div class="section" id="define-security-rules">
<h3>Define Security Rules<a class="headerlink" href="#define-security-rules" title="Permalink to this headline">¶</a></h3>
<p>You are now ready to create rules in your Security Groups.</p>
<p>To do so, click on the right arrow on the right side of the Security
Group you want to edit.</p>
<p>Once in the Security Group details, click on the &#8220;+&#8221; next to &#8220;Rule&#8221; to
add a new rule, a pop-up will come out.</p>
<p>This pop-up allows you to define the following rules:</p>
<ul class="simple">
<li>Direction (incoming or outgoing traffic)</li>
<li>Source/Destination<ul>
<li>IP/range (CIDR notation)</li>
<li>Other Security Group</li>
</ul>
</li>
<li>Protocol<ul>
<li>TCP: allow all TCP traffic on the selected port/range (&#8220;0-65535&#8221;
for all)</li>
<li>UDP: allow all UDP traffic on the selected port/range (&#8220;0-65535&#8221;
for all)</li>
<li>ICMP: select an ICMP packet type to allow (see the list for more
details)</li>
<li>Custom: allow all traffic on a custom protocol</li>
<li>All: allow all traffic on the selected port/range (&#8220;0-65535&#8221; for
all)</li>
</ul>
</li>
</ul>
<p>Here is a simple example with two web servers and one database server.
We defined the following rules:</p>
<table>
    <tbody>
        <tr>
            <td rowspan="2"><p>SG</p>
</td>
            <td colspan="4"><p>Security Group Rules</p>
</td>
        </tr>
        <tr style="border-bottom: 1px solid gray;">
            <td><p>In / Out</p>
</td>
            <td><p>Soure / Dest</p>
</td>
            <td><p>Protocol</p>
</td>
            <td><p>Port Range</p>
</td>
        </tr>
        <tr>
            <td rowspan="7"><p>custom-sg-1</p>
</td>
            <td rowspan="3" style="border-left: 1px solid gray;"><p>In</p>
</td>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>22</p>
</td>
        </tr>
        <tr>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>80</p>
</td>
        </tr>
        <tr>
            <td><p>SG: custom-sg-1</p>
</td>
            <td><p>All</p>
</td>
            <td><p>0-65535</p>
</td>
        </tr>
        <tr>
            <td rowspan="4" style="border-left: 1px solid gray;"><p>Out</p>
</td>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>80</p>
</td>
        </tr>
        <tr>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>443</p>
</td>
        </tr>
        <tr>
            <td><p>SG: custom-sg-1</p>
</td>
            <td><p>All</p>
</td>
            <td><p>0-65535</p>
</td>
        </tr>
        <tr style="border-bottom: 1px solid gray;">
            <td><p>SG: custom-sg-2</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>3306</p>
</td>
        </tr>
        <tr>
            <td rowspan="6"><p>custom-sg-2</p>
</td>
            <td rowspan="3" style="border-left: 1px solid gray;"><p>In</p>
</td>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>22</p>
</td>
        </tr>
        <tr>
            <td><p>SG: custom-sg-1</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>3306</p>
</td>
        </tr>
        <tr style="border-bottom: 1px solid gray;">
            <td><p>SG: custom-sg-2</p>
</td>
            <td><p>All</p>
</td>
            <td><p>0-65535</p>
</td>
        </tr>
        <tr>
            <td rowspan="3" style="border-left: 1px solid gray;"><p>Out</p>
</td>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>80</p>
</td>
        </tr>
        <tr>
            <td><p>IP range: 0.0.0.0/0</p>
</td>
            <td><p>TCP</p>
</td>
            <td><p>443</p>
</td>
        </tr>
        <tr>
            <td><p>SG: custom-sg-2</p>
</td>
            <td><p>All</p>
</td>
            <td><p>0-65535</p>
</td>
        </tr>
    </tbody>
</table><div class="figure">
<img alt="" src="ide_stack_sgc1.png" />
</div>
<div class="figure">
<img alt="" src="ide_stack_sgc2.png" />
</div>
</div>
</div>
<div class="section" id="network-acl-vpc-stack-only">
<h2>3.4.2 Network ACL (VPC Stack only)<a class="headerlink" href="#network-acl-vpc-stack-only" title="Permalink to this headline">¶</a></h2>
<p>The Network ACL can be edited in the VPC properties.</p>
<p>The Network ACL acts as a complementary firewall to the Security Groups,
to control an entire Subnet.</p>
<p>The ACL rules definition work the same way as Security Rules. It will
not be described here, for more information about ACLs, please learn how
to define Security Groups, then read this article.</p>
</div>
<div class="section" id="app-management">
<h2>4. App management<a class="headerlink" href="#app-management" title="Permalink to this headline">¶</a></h2>
<div class="figure">
<img alt="" src="ide_app_all.png" />
</div>
<p>The App screen is where you monitor your running App(s).</p>
<div class="section" id="id5">
<h3>Composition<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The App management screen is mainly composed of three areas:</p>
<ul class="simple">
<li>The App visualisation in the middle</li>
<li>The property pannel on the right</li>
<li>The tool bar on the top</li>
</ul>
</div>
<div class="section" id="id6">
<h3>Access<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>To access the App management screen, you can either run a new Stack or
view an already started one. Simply click on the &#8220;Run Stack&#8221; button to
run a new Stack, or click on the third icon on the left menubar, then
select the App of your choice to view an already existing App.</p>
<div class="figure">
<img alt="" src="ide_app_access.png" />
</div>
</div>
<div class="section" id="properties">
<h3>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h3>
<p>You can display the properties of each element of your App from this
screen.</p>
<p>In our example, simply click on an instance to display the properties on
the right pannel.</p>
<div class="figure">
<img alt="" src="ide_app_inst.png" />
</div>
</div>
</div>
</div>


          </div>
              <div class="footer">
                  &copy; Copyright 2013, MadeiraCloud.
              </div>
        </div>


      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="default.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started: Normal Mode</a><ul>
<li><a class="reference internal" href="#overview">1. Overview</a></li>
<li><a class="reference internal" href="#connecting-madeiracloud-and-aws">2. Connecting MadeiraCloud and AWS</a><ul>
<li><a class="reference internal" href="#prerequisites">2.1 Prerequisites</a></li>
<li><a class="reference internal" href="#entering-your-credentials">2.2 Entering your Credentials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#b-connecting-madeiracloud-and-aws-using-iam">2b. Connecting MadeiraCloud and AWS using IAM</a><ul>
<li><a class="reference internal" href="#make-sure-iam-access-is-enabled">Make sure IAM access is enabled.</a></li>
<li><a class="reference internal" href="#create-a-user-for-use-with-madeiracloud">Create a user for use with MadeiraCloud.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#designing-a-simple-stack-drupal-mysql-ha-example">3. Designing a simple Stack (Drupal MySQL HA example)</a></li>
<li><a class="reference internal" href="#setting-up-your-application-drupal-mysql-ha-example">4. Setting up your application (Drupal MySQL HA example)</a><ul>
<li><a class="reference internal" href="#disclamer">Disclamer</a></li>
<li><a class="reference internal" href="#setting-up-the-instances">Setting up the instances</a></li>
<li><a class="reference internal" href="#deploying-drupal">Deploying Drupal</a></li>
<li><a class="reference internal" href="#configure-the-primarydb">Configure the primarydb</a></li>
<li><a class="reference internal" href="#setting-up-drupal">Setting up Drupal</a></li>
<li><a class="reference internal" href="#setting-up-mysql-ha">Setting up MySQL HA</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#getting-started-virtual-private-cloud-vpc-mode">Getting Started: Virtual Private Cloud (VPC) Mode</a><ul>
<li><a class="reference internal" href="#overview-of-vpc-and-aws-platforms">1. Overview of VPC and AWS Platforms</a><ul>
<li><a class="reference internal" href="#ec2-classic">EC2-Classic</a></li>
<li><a class="reference internal" href="#ec2-vpc-non-default-vpc">EC2-VPC (non-default VPC)</a></li>
<li><a class="reference internal" href="#ec2-vpc-default-vpc">EC2-VPC (default VPC)</a></li>
<li><a class="reference internal" href="#stack-restrictions">Stack Restrictions:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#step-by-step-tutorials">2. Step-by-step tutorials</a></li>
<li><a class="reference internal" href="#vpc-with-a-public-subnet-only">2.1 VPC with a Public Subnet Only</a><ul>
<li><a class="reference internal" href="#optionally">Optionally</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vpc-with-public-and-private-subnets">2.2 VPC with Public and Private Subnets</a></li>
<li><a class="reference internal" href="#vpc-with-public-and-private-subnets-and-hardware-vpn-access">2.3 VPC with Public and Private Subnets and Hardware VPN Access</a></li>
<li><a class="reference internal" href="#vpc-with-a-private-subnet-only-and-hardware-vpn-access">2.4 VPC with a Private Subnet Only and Hardware VPN Access</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ide-interface">IDE interface</a><ul>
<li><a class="reference internal" href="#global-details">1 Global details</a></li>
<li><a class="reference internal" href="#description">1.1 Description</a></li>
<li><a class="reference internal" href="#userbar">1.2 Userbar</a></li>
<li><a class="reference internal" href="#dashboard">2. Dashboard</a></li>
<li><a class="reference internal" href="#id1">2.1 Description</a><ul>
<li><a class="reference internal" href="#access">Access</a></li>
<li><a class="reference internal" href="#stack-creation-button">Stack creation button</a></li>
</ul>
</li>
<li><a class="reference internal" href="#main-view">2.2 Main view</a></li>
<li><a class="reference internal" href="#global-dashboard">2.3 Global Dashboard</a></li>
<li><a class="reference internal" href="#region-specific-dashboard">2.4 Region specific Dashboard</a><ul>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
<li><a class="reference internal" href="#stack-edition">3. Stack edition</a></li>
<li><a class="reference internal" href="#id2">3.1 Description</a><ul>
<li><a class="reference internal" href="#composition">Composition</a></li>
<li><a class="reference internal" href="#id3">Access</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resources">3.2 Resources</a></li>
<li><a class="reference internal" href="#availability-zones">3.2.1 Availability Zones</a></li>
<li><a class="reference internal" href="#images">3.2.2 Images</a><ul>
<li><a class="reference internal" href="#images-source">Images source</a></li>
</ul>
</li>
<li><a class="reference internal" href="#volume-and-snapshots">3.2.3 Volume and Snapshots</a></li>
<li><a class="reference internal" href="#load-balancer-and-auto-scaling">3.2.4 Load Balancer and Auto Scaling</a><ul>
<li><a class="reference internal" href="#load-balancers">Load Balancers</a></li>
<li><a class="reference internal" href="#auto-scaling-groups">Auto Scaling Groups</a></li>
</ul>
</li>
<li><a class="reference internal" href="#eips">3.2.5 EIPs</a></li>
<li><a class="reference internal" href="#virtual-private-cloud-vpc-stack-only">3.2.6 Virtual Private Cloud (VPC Stack only)</a><ul>
<li><a class="reference internal" href="#subnet">Subnet</a></li>
<li><a class="reference internal" href="#route-table">Route Table</a></li>
<li><a class="reference internal" href="#internet-gateway">Internet Gateway</a></li>
<li><a class="reference internal" href="#virtual-gateway">Virtual Gateway</a></li>
<li><a class="reference internal" href="#customer-gateway">Customer Gateway</a></li>
<li><a class="reference internal" href="#network-interface">Network Interface</a></li>
</ul>
</li>
<li><a class="reference internal" href="#top-menu-bar">3.3 Top menu bar</a></li>
<li><a class="reference internal" href="#security">3.4 Security</a></li>
<li><a class="reference internal" href="#security-groups">3.4.1 Security Groups</a><ul>
<li><a class="reference internal" href="#id4">Description</a></li>
<li><a class="reference internal" href="#default-security-group">Default Security Group</a></li>
<li><a class="reference internal" href="#create-a-custom-security-group">Create a custom Security Group</a></li>
<li><a class="reference internal" href="#associate-a-custom-security-group">Associate a custom Security Group</a></li>
<li><a class="reference internal" href="#define-security-rules">Define Security Rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#network-acl-vpc-stack-only">3.4.2 Network ACL (VPC Stack only)</a></li>
<li><a class="reference internal" href="#app-management">4. App management</a><ul>
<li><a class="reference internal" href="#id5">Composition</a></li>
<li><a class="reference internal" href="#id6">Access</a></li>
<li><a class="reference internal" href="#properties">Properties</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="default.html"
                        title="previous chapter">Madeira Cloud Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/h5_doc.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <!--
        <ul>
          <li class="right" style="margin-right: 10px">
            <a href="genindex.html" title="General Index"
               >index</a></li>
          <li class="right" >
            <a href="default.html" title="Madeira Cloud Documentation"
               >previous</a> |</li>
          <li><a href="default.html">MadeiraCloud Document 1.0.0 documentation</a> &raquo;</li> 
        </ul>
      -->
    </div>

  </body>
</html>